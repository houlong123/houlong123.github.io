<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>TreeMapæºç å­¦ä¹  | è€Œä»Šä¼Šå§‹ï¼Œå‘½é€”è‡ªé—¯</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="å‰è¨€TreeMap æ˜¯ Javaé›†åˆæ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦ä¸€ä¸ªçš„å®ç°ã€‚TreeMap åº•å±‚åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œå¯ä¿è¯åœ¨log(n)æ—¶é—´å¤æ‚åº¦å†…å®Œæˆ containsKeyã€getã€put å’Œ remove æ“ä½œï¼Œæ•ˆç‡å¾ˆé«˜ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºTreeMap åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œè¿™ä¸º TreeMap ä¿æŒé”®çš„æœ‰åºæ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚ ç”±äº TreeMap åº•å±‚åŸºäº çº¢é»‘æ ‘ å®ç°ï¼Œå› æ­¤ï¼Œåœ¨å­¦ä¹  TreeMap æºç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦">
<meta name="keywords" content="javaåŸºç¡€é›†åˆ">
<meta property="og:type" content="article">
<meta property="og:title" content="TreeMapæºç å­¦ä¹ ">
<meta property="og:url" content="https://houlong123.github.io/2018/02/26/TreeMapæºç å­¦ä¹ /index.html">
<meta property="og:site_name" content="è€Œä»Šä¼Šå§‹ï¼Œå‘½é€”è‡ªé—¯">
<meta property="og:description" content="å‰è¨€TreeMap æ˜¯ Javaé›†åˆæ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦ä¸€ä¸ªçš„å®ç°ã€‚TreeMap åº•å±‚åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œå¯ä¿è¯åœ¨log(n)æ—¶é—´å¤æ‚åº¦å†…å®Œæˆ containsKeyã€getã€put å’Œ remove æ“ä½œï¼Œæ•ˆç‡å¾ˆé«˜ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºTreeMap åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œè¿™ä¸º TreeMap ä¿æŒé”®çš„æœ‰åºæ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚ ç”±äº TreeMap åº•å±‚åŸºäº çº¢é»‘æ ‘ å®ç°ï¼Œå› æ­¤ï¼Œåœ¨å­¦ä¹  TreeMap æºç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Red-black_tree_example.svg/900px-Red-black_tree_example.svg.png">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1637925-fbb109dbaa9b2c48.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/329">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1637925-185dea52a871f85e.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/301">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/8/8a/%E5%89%8D%E5%BA%8F%E9%81%8D%E5%8E%86.png">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/c/c4/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86.png">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/7/7f/%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86.png">
<meta property="og:image" content="http://t.cn/RQ0ic37">
<meta property="og:image" content="http://t.cn/RQ0ic3v">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/c/c4/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86.png">
<meta property="og:updated_time" content="2018-02-26T10:08:08.481Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TreeMapæºç å­¦ä¹ ">
<meta name="twitter:description" content="å‰è¨€TreeMap æ˜¯ Javaé›†åˆæ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦ä¸€ä¸ªçš„å®ç°ã€‚TreeMap åº•å±‚åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œå¯ä¿è¯åœ¨log(n)æ—¶é—´å¤æ‚åº¦å†…å®Œæˆ containsKeyã€getã€put å’Œ remove æ“ä½œï¼Œæ•ˆç‡å¾ˆé«˜ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºTreeMap åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œè¿™ä¸º TreeMap ä¿æŒé”®çš„æœ‰åºæ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚ ç”±äº TreeMap åº•å±‚åŸºäº çº¢é»‘æ ‘ å®ç°ï¼Œå› æ­¤ï¼Œåœ¨å­¦ä¹  TreeMap æºç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Red-black_tree_example.svg/900px-Red-black_tree_example.svg.png">
  
    <link rel="alternate" href="/atom.xml" title="è€Œä»Šä¼Šå§‹ï¼Œå‘½é€”è‡ªé—¯" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">è€Œä»Šä¼Šå§‹ï¼Œå‘½é€”è‡ªé—¯</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://houlong123.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-TreeMapæºç å­¦ä¹ " class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/26/TreeMapæºç å­¦ä¹ /" class="article-date">
  <time datetime="2018-02-26T10:06:58.000Z" itemprop="datePublished">2018-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      TreeMapæºç å­¦ä¹ 
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>TreeMap æ˜¯ Javaé›†åˆæ¡†æ¶ä¸­æ¯”è¾ƒé‡è¦ä¸€ä¸ªçš„å®ç°ã€‚TreeMap åº•å±‚åŸºäº<font color="red">çº¢é»‘æ ‘</font>å®ç°ï¼Œå¯ä¿è¯åœ¨log(n)æ—¶é—´å¤æ‚åº¦å†…å®Œæˆ containsKeyã€getã€put å’Œ remove æ“ä½œï¼Œæ•ˆç‡å¾ˆé«˜ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºTreeMap åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œè¿™ä¸º TreeMap ä¿æŒé”®çš„æœ‰åºæ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚</p>
<p>ç”±äº TreeMap åº•å±‚åŸºäº çº¢é»‘æ ‘ å®ç°ï¼Œå› æ­¤ï¼Œåœ¨å­¦ä¹  TreeMap æºç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå­¦ä¹ ä¸€ä¸‹<a href="https://zh.wikipedia.org/wiki/%E7%BA%A2%E9%BB%91%E6%A0%91" target="_blank" rel="noopener">çº¢é»‘æ ‘</a>çš„åŸºç¡€çŸ¥è¯†ã€‚</p>
<h4 id="çº¢é»‘æ ‘çŸ¥è¯†å­¦ä¹ "><a href="#çº¢é»‘æ ‘çŸ¥è¯†å­¦ä¹ " class="headerlink" title="çº¢é»‘æ ‘çŸ¥è¯†å­¦ä¹ "></a>çº¢é»‘æ ‘çŸ¥è¯†å­¦ä¹ </h4><h5 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p>çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ˜¯ä¸€ç§é«˜æ•ˆçš„æŸ¥æ‰¾æ ‘ã€‚<br><a id="more"></a></p>
<h5 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h5><p>çº¢é»‘æ ‘æ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½å¸¦æœ‰é¢œè‰²å±æ€§çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œé¢œè‰²ä¸ºçº¢è‰²æˆ–é»‘è‰²ã€‚åœ¨äºŒå‰æŸ¥æ‰¾æ ‘å¼ºåˆ¶ä¸€èˆ¬è¦æ±‚ä»¥å¤–ï¼Œå¯¹äºä»»ä½•æœ‰æ•ˆçš„çº¢é»‘æ ‘æˆ‘ä»¬å¢åŠ äº†å¦‚ä¸‹çš„é¢å¤–è¦æ±‚ï¼š</p>
<ol>
<li>èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–é»‘è‰²ã€‚</li>
<li>æ ¹æ˜¯é»‘è‰²ã€‚</li>
<li>æ‰€æœ‰å¶å­éƒ½æ˜¯é»‘è‰²ï¼ˆå¶å­æ˜¯NILèŠ‚ç‚¹ï¼‰ã€‚</li>
<li>æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹å¿…é¡»æœ‰ä¸¤ä¸ªé»‘è‰²çš„å­èŠ‚ç‚¹ã€‚ï¼ˆä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ã€‚ï¼‰</li>
<li>ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰ç®€å•è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚</li>
</ol>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Red-black_tree_example.svg/900px-Red-black_tree_example.svg.png" alt="image"></p>
<h5 id="æ—‹è½¬"><a href="#æ—‹è½¬" class="headerlink" title="æ—‹è½¬"></a>æ—‹è½¬</h5><p>åœ¨ä¿®æ”¹äºŒå‰æ ‘çš„ç»“æ„åï¼Œä¼šæ¶‰åŠåˆ°å¯¹æ ‘ç»“æ„çš„è°ƒæ•´ï¼Œæ­¤æ—¶ä¼šæœ‰æ—‹è½¬æ“ä½œã€‚æ—‹è½¬æ“ä½œåˆ†ä¸ºå·¦æ—‹å’Œå³æ—‹ï¼Œå·¦æ—‹æ˜¯å°†æŸä¸ªèŠ‚ç‚¹æ—‹è½¬ä¸ºå…¶å³å­©å­çš„å·¦å­©å­ï¼Œè€Œå³æ—‹æ˜¯èŠ‚ç‚¹æ—‹è½¬ä¸ºå…¶å·¦å­©å­çš„å³å­©å­ã€‚</p>
<ol>
<li><p>å·¦æ—‹</p>
<p> <img src="https://upload-images.jianshu.io/upload_images/1637925-fbb109dbaa9b2c48.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/329" alt="å·¦æ—‹"></p>
</li>
<li><p>å³æ—‹</p>
<p> <img src="https://upload-images.jianshu.io/upload_images/1637925-185dea52a871f85e.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/301" alt="image"></p>
</li>
</ol>
<h5 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h5><p>äºŒå‰æ ‘çš„éå†ï¼Œç®€å•å¯ä»¥åˆ’åˆ†ä¸ºï¼š</p>
<ol>
<li>æ·±åº¦ä¼˜å…ˆ</li>
<li>å¹¿åº¦ä¼˜å…ˆ</li>
</ol>
<p>å…¶ä¸­ï¼Œæ·±åº¦ä¼˜å…ˆæ ¹æ®æ ¹èŠ‚ç‚¹ç›¸å¯¹äºå·¦å³å­èŠ‚ç‚¹çš„è®¿é—®å…ˆåæ¥åˆ’åˆ†ä¸ºï¼š</p>
<ol>
<li><p>å…ˆåºéå†ï¼šæŒ‡å…ˆè®¿é—®æ ¹ï¼Œç„¶åè®¿é—®å­æ ‘çš„éå†æ–¹å¼</p>
<p> <img src="https://upload.wikimedia.org/wikipedia/commons/8/8a/%E5%89%8D%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="å…ˆåºéå†"></p>
</li>
<li><p>ä¸­åºéå†ï¼šæŒ‡å…ˆè®¿é—®å·¦ï¼ˆå³ï¼‰å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹ï¼Œæœ€åè®¿é—®å³ï¼ˆå·¦ï¼‰å­æ ‘çš„éå†æ–¹å¼</p>
<p> <img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="ä¸­åºéå†"></p>
</li>
<li><p>ååºéå†ï¼šæŒ‡å…ˆè®¿é—®å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹çš„éå†æ–¹å¼</p>
<p> <img src="https://upload.wikimedia.org/wikipedia/commons/7/7f/%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="ååºéå†"></p>
</li>
</ol>
<p>å…³äºäºŒå‰æ ‘çš„æ’å…¥ï¼Œåˆ é™¤ç­‰æ“ä½œï¼Œç”±äºå¤ªè¿‡å¤æ‚ï¼Œæœ¬æ–‡ä¸åšè®²è¿°ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ–‡å‚è€ƒæ–‡ç« è¿›è¡Œå­¦ä¹ ã€‚</p>
<h4 id="æºç å­¦ä¹ "><a href="#æºç å­¦ä¹ " class="headerlink" title="æºç å­¦ä¹ "></a>æºç å­¦ä¹ </h4><h5 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">NavigableMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç»´æŒTreeMapå†…éƒ¨å…ƒç´ é¡ºåºçš„æ¯”è¾ƒå™¨ã€‚åœ¨ä¸ºnullçš„æ—¶å€™ï¼Œä½¿ç”¨é”®è‡ªèº«çš„è‡ªç„¶é¡ºåºã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;? <span class="keyword">super</span> K&gt; comparator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt; root;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> modCount = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://t.cn/RQ0ic37" alt="ç»§æ‰¿å›¾"></p>
<p>ä» TreeMap ç±»çš„å£°æ˜ä¸­ï¼Œå¯çŸ¥è¯¥ç±»ç»§æ‰¿äº† <code>AbstractMapæŠ½è±¡ç±»ï¼Œå¹¶å®ç°äº†NavigableMap æ¥å£</code>ã€‚ä¸”å†…éƒ¨æœ‰ä¸ªåä¸º <code>comparator</code> çš„å±æ€§ï¼Œç”¨äºåœ¨æ’å…¥å…ƒç´ æ—¶è¿›è¡Œå…ƒç´ æ’åºä½¿ç”¨ã€‚ç”±äºåº•å±‚ä¸ºçº¢é»‘æ ‘ï¼Œå› æ­¤æœ‰ä¸ª <code>root</code> å±æ€§ç”¨äºè¡¨ç¤ºæ ‘æ ¹ã€‚</p>
<p>NavigableMap æ¥å£å£°æ˜äº†ä¸€ç³»åˆ—å…·æœ‰å¯¼èˆªåŠŸèƒ½çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">NavigableMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">SortedMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//è¿”å›é”®å€¼å°äºå‚æ•°keyçš„æœ€å¤§é”®å€¼å¯¹</span></span><br><span class="line">    <span class="function">Entry&lt;K,V&gt; <span class="title">lowerEntry</span><span class="params">(K key)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿”å›é”®å€¼å°äºå‚æ•°keyçš„æœ€å¤§é”®å€¼</span></span><br><span class="line">    <span class="function">K <span class="title">lowerKey</span><span class="params">(K key)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿”å›é”®å€¼ä¸å¤§äºå‚æ•°keyçš„æœ€å¤§é”®å€¼å¯¹</span></span><br><span class="line">    <span class="function">Entry&lt;K,V&gt; <span class="title">floorEntry</span><span class="params">(K key)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿”å›é”®å€¼ä¸å¤§äºå‚æ•°keyçš„æœ€å¤§é”®å€¼</span></span><br><span class="line">    <span class="function">K <span class="title">floorKey</span><span class="params">(K key)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿”å›é”®å€¼ä¸å°äºå‚æ•°keyçš„æœ€å°é”®å€¼å¯¹</span></span><br><span class="line">    <span class="function">Entry&lt;K,V&gt; <span class="title">ceilingEntry</span><span class="params">(K key)</span></span>;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºæ ‘å½¢é”®å€¼å¯¹æ˜ å°„é›†åˆã€‚ä½¿ç”¨é”®çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºã€‚ç”±æ­¤æ„é€ å‡½æ•°åˆ›å»ºçš„æ˜ å°„é›†åˆä¸­å­˜å‚¨çš„å…ƒç´ å¿…é¡»å®ç°Comparableæ¥å£ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TreeMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    comparator = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨æŒ‡å®šæ¯”è¾ƒå™¨åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºæ ‘å½¢é”®å€¼å¯¹æ˜ å°„é›†åˆã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TreeMap</span><span class="params">(Comparator&lt;? <span class="keyword">super</span> K&gt; comparator)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.comparator = comparator;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TreeMap</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;</span><br><span class="line">    comparator = <span class="keyword">null</span>;</span><br><span class="line">    putAll(m);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TreeMap</span><span class="params">(SortedMap&lt;K, ? extends V&gt; m)</span> </span>&#123;</span><br><span class="line">    comparator = m.comparator();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        buildFromSorted(m.size(), m.entrySet().iterator(), <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (java.io.IOException cannotHappen) &#123;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException cannotHappen) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TreeMap çš„æ„é€ å‡½æ•°ä¸»è¦åŠŸèƒ½æ˜¯è®¾ç½®å…ƒç´ æ¯”è¾ƒå™¨ã€‚åœ¨æ¯”è¾ƒå™¨ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨é”®çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºã€‚ç”±æ­¤æ˜ å°„é›†åˆä¸­å­˜å‚¨çš„é”®å€¼å¿…é¡»å®ç°Comparableæ¥å£ã€‚</p>
<h5 id="æ·»åŠ å…ƒç´ "><a href="#æ·»åŠ å…ƒç´ " class="headerlink" title="æ·»åŠ å…ƒç´ "></a>æ·»åŠ å…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    Entry&lt;K,V&gt; t = root;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ ¹èŠ‚ç‚¹ä¸º nullï¼Œå°†æ–°èŠ‚ç‚¹è®¾ä¸ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç±»å‹æ ¡éªŒ</span></span><br><span class="line">        compare(key, key); <span class="comment">// type (and possibly null) check</span></span><br><span class="line"></span><br><span class="line">        root = <span class="keyword">new</span> Entry&lt;&gt;(key, value, <span class="keyword">null</span>);</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cmp;</span><br><span class="line">    Entry&lt;K,V&gt; parent;</span><br><span class="line">    <span class="comment">// split comparator and comparable paths</span></span><br><span class="line">    Comparator&lt;? <span class="keyword">super</span> K&gt; cpr = comparator;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¯”è¾ƒå™¨ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨æŒ‡å®šæ¯”è¾ƒå™¨è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾åˆ°å¾…æ’å…¥å…ƒç´ åœ¨çº¢é»‘æ ‘ä¸­åˆé€‚çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">if</span> (cpr != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = cpr.compare(key, t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span>    <span class="comment">//æŒ‡å®šé”®å€¼å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œé‡æ–°è®¾ç½®å¯¹åº”çš„valueï¼Œå¹¶è¿”å›æ—§çš„value</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value);</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¯”è¾ƒå™¨ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨é”®å€¼è‡ªèº«é¡ºåºè¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾åˆ°å¾…æ’å…¥å…ƒç´ åœ¨çº¢é»‘æ ‘ä¸­åˆé€‚çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">        Comparable&lt;? <span class="keyword">super</span> K&gt; k = (Comparable&lt;? <span class="keyword">super</span> K&gt;) key;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = k.compareTo(t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value);</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”±ä»¥ä¸Šä»£ç æ‰¾åˆ°å¾…æ’å…¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹åï¼Œç»„è£…èŠ‚ç‚¹ï¼Œå¹¶å°†æ–°èŠ‚ç‚¹æ’å…¥çº¢é»‘æ ‘</span></span><br><span class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> Entry&lt;&gt;(key, value, parent);</span><br><span class="line">    <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        parent.left = e;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        parent.right = e;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ’å…¥æ–°èŠ‚ç‚¹å¯èƒ½ä¼šç ´åçº¢é»‘æ ‘æ€§è´¨ï¼Œè¿™é‡Œä¿®æ­£ä¸€ä¸‹</span></span><br><span class="line">    fixAfterInsertion(e);</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ’å…¥å…ƒç´ ä¹‹å‰ï¼Œå¦‚æœæ ‘è¿˜æ²¡åˆå§‹åŒ–ï¼Œåˆ™ç›´æ¥å°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹ï¼›å¦åˆ™ï¼Œåœ¨æ ‘ç»“æ„ä¸­æ ¹æ®æ¯”è¾ƒå™¨æ‰¾åˆ°æ–°èŠ‚ç‚¹åœ¨çº¢é»‘æ ‘ä¸­çš„é€‚å½“ä½ç½®ï¼Œç„¶åå°†æ–°èŠ‚ç‚¹æ’å…¥æ•°ä¸­ï¼›åœ¨æ’å…¥æˆåŠŸåï¼Œè°ƒç”¨ <code>fixAfterInsertionæ–¹æ³•</code> è°ƒæ•´ä¸€ä¸‹çº¢é»‘æ ‘ç»“æ„ã€‚</p>
<p>åœ¨ç¡®è®¤æ–°èŠ‚ç‚¹æ’å…¥çš„ä½ç½®æ—¶ï¼Œå¦‚æœæ–°èŠ‚ç‚¹çš„keyå€¼æ¯”çˆ¶èŠ‚ç‚¹çš„å°ï¼Œåˆ™å°†æ–°èŠ‚ç‚¹æ”¾åœ¨æ ‘ç»“æ„çš„å·¦èŠ‚ç‚¹ä½ç½®ï¼›å¦åˆ™ï¼Œä¸ºå³èŠ‚ç‚¹ä½ç½®ã€‚æœ€ç»ˆçš„ç»“æ„æ˜¯ï¼š<font color="red">æ ‘ç»“æ„ä¸­ï¼Œçˆ¶èŠ‚ç‚¹çš„keyå€¼å¤§äºå…¶å·¦èŠ‚ç‚¹çš„keyå€¼ï¼Œä¸”å°äºå…¶å³èŠ‚ç‚¹çš„keyå€¼ã€‚</font></p>
<h5 id="fixAfterInsertionæºç "><a href="#fixAfterInsertionæºç " class="headerlink" title="fixAfterInsertionæºç "></a>fixAfterInsertionæºç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  çº¢é»‘æ ‘çš„æ€§è´¨ï¼š</span></span><br><span class="line"><span class="comment"> *      1. èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–é»‘è‰²ã€‚</span></span><br><span class="line"><span class="comment">        2. æ ¹æ˜¯é»‘è‰²ã€‚</span></span><br><span class="line"><span class="comment">        3. æ‰€æœ‰å¶å­éƒ½æ˜¯é»‘è‰²ï¼ˆå¶å­æ˜¯NILèŠ‚ç‚¹ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">        4. æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹å¿…é¡»æœ‰ä¸¤ä¸ªé»‘è‰²çš„å­èŠ‚ç‚¹ã€‚ï¼ˆä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ã€‚ï¼‰</span></span><br><span class="line"><span class="comment">        5. ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰ç®€å•è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment"> * åœ¨æ–°èŠ‚ç‚¹æˆåŠŸæ’å…¥åï¼Œå¯èƒ½ä¼šç ´åçº¢é»‘æ ‘æ€§è´¨ï¼Œå› ä¸ºéœ€è¦ä½¿ç”¨ fixAfterInsertion æ–¹æ³•è¿›è¡Œä¿®æ­£ä¸€ä¸‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fixAfterInsertion</span><span class="params">(Entry&lt;K,V&gt; x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å…ˆæ’å…¥çš„èŠ‚ç‚¹å˜ä¸ºçº¢è‰²</span></span><br><span class="line">    x.color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (x != <span class="keyword">null</span> &amp;&amp; x != root &amp;&amp; x.parent.color == RED) &#123;</span><br><span class="line">        <span class="keyword">if</span> (parentOf(x) == leftOf(parentOf(parentOf(x)))) &#123;  <span class="comment">//åˆ¤æ–­èŠ‚ç‚¹xçš„çˆ¶èŠ‚ç‚¹æ˜¯å·¦èŠ‚ç‚¹è¿˜æ˜¯å³èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//è·å–èŠ‚ç‚¹xçš„å”çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">            Entry&lt;K,V&gt; y = rightOf(parentOf(parentOf(x)));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//èŠ‚ç‚¹xçš„å”çˆ¶èŠ‚ç‚¹ä¸ºçº¢è‰²ï¼Œå˜è‰²å¤„ç†</span></span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å°†èŠ‚ç‚¹xçš„çˆ¶èŠ‚ç‚¹åŠå…¶å”çˆ¶èŠ‚ç‚¹å˜ä¸ºé»‘è‰²</span></span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å°†èŠ‚ç‚¹xçš„ç¥–çˆ¶èŠ‚ç‚¹å˜æˆçº¢è‰²</span></span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å‘ä¸Šè°ƒæ•´ç¥–çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">//èŠ‚ç‚¹xçš„å”çˆ¶èŠ‚ç‚¹ä¸ºé»‘è‰²ï¼Œåˆ™è°ƒæ•´ç»“æ„</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//èŠ‚ç‚¹xä¸ºå³èŠ‚ç‚¹ï¼Œå·¦æ—‹</span></span><br><span class="line">                <span class="keyword">if</span> (x == rightOf(parentOf(x))) &#123;</span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    rotateLeft(x);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å³æ—‹ï¼Œå˜è‰²</span></span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateRight(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Entry&lt;K,V&gt; y = leftOf(parentOf(parentOf(x)));</span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (x == leftOf(parentOf(x))) &#123;</span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    rotateRight(x);</span><br><span class="line">                &#125;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateLeft(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    root.color = BLACK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°æ–¹æ³•çš„åŠŸèƒ½æ˜¯ï¼šåœ¨çº¢é»‘æ ‘çš„ç»“æ„å‘ç”Ÿæ”¹å˜åï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œç›¸åº”è°ƒæ•´ï¼Œå·²æ»¡è¶³çº¢é»‘æ ‘çš„æ€§è´¨ã€‚</p>
<p>ä¸‹å›¾ä¸ºä»£ç é€»è¾‘æ‰€å¯¹åº”çš„å›¾è§£ï¼š</p>
<p><img src="http://t.cn/RQ0ic3v" alt="è°ƒæ•´é€»è¾‘å›¾"></p>
<hr>
<h5 id="è·å–å…ƒç´ "><a href="#è·å–å…ƒç´ " class="headerlink" title="è·å–å…ƒç´ "></a>è·å–å…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Entry&lt;K,V&gt; p = getEntry(key);</span><br><span class="line">    <span class="keyword">return</span> (p==<span class="keyword">null</span> ? <span class="keyword">null</span> : p.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">getEntry</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Offload comparator-based version for sake of performance</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¦‚æœæ¯”è¾ƒå™¨ä¸ä¸ºnullï¼Œåˆ™ä½¿ç”¨ç‰¹å®šæ¯”è¾ƒå™¨è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">if</span> (comparator != <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> getEntryUsingComparator(key);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æ¯”è¾ƒå™¨ä¸ºnullçš„æƒ…å†µä¸‹ï¼Œé”®å€¼ä¸èƒ½ä¸ºnullï¼Œå¦åˆ™ä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æ¯”è¾ƒå™¨ä¸ºnullçš„æƒ…å†µä¸‹ï¼Œé›†åˆä¸­æ‰€å­˜å‚¨çš„é”®å€¼å¿…é¡»å®ç°äº†Comparableæ¥å£ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    Comparable&lt;? <span class="keyword">super</span> K&gt; k = (Comparable&lt;? <span class="keyword">super</span> K&gt;) key;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ©ç”¨æ¯”è¾ƒå™¨çš„ç‰¹æ€§å¼€å§‹æ¯”è¾ƒå¤§å°  ç›¸åŒ return å°äº ä»å·¦å­æ ‘å¼€å§‹ å¤§äº† ä»å³å­æ ‘å¼€å§‹</span></span><br><span class="line">    Entry&lt;K,V&gt; p = root;</span><br><span class="line">    <span class="keyword">while</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> cmp = k.compareTo(p.key);</span><br><span class="line">        <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">            p = p.left;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">            p = p.right;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æŸ¥æ‰¾å…ƒç´ çš„æ—¶å€™ï¼Œæ€»ä½“é€»è¾‘æ˜¯ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¦‚æœç›®æ ‡å€¼å°äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™å†å’Œæ ¹èŠ‚ç‚¹çš„å·¦å­©å­è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœç›®æ ‡å€¼å¤§äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™ç»§ç»­å’Œæ ¹èŠ‚ç‚¹çš„å³å­©å­æ¯”è¾ƒã€‚åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œå¦‚æœç›®æ ‡å€¼å’ŒäºŒå‰æ ‘ä¸­çš„æŸä¸ªèŠ‚ç‚¹å€¼ç›¸ç­‰ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å› falseã€‚</p>
<h5 id="containsValueæºç "><a href="#containsValueæºç " class="headerlink" title="containsValueæºç "></a>containsValueæºç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsValue</span><span class="params">(Object value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Entry&lt;K,V&gt; e = getFirstEntry(); e != <span class="keyword">null</span>; e = successor(e))</span><br><span class="line">        <span class="keyword">if</span> (valEquals(value, e.value))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨åˆ¤æ–­æ˜ å°„ä¸­æ˜¯å¦åŒ…å«ç‰¹å®šçš„å€¼æ—¶ï¼Œä¼šæ ¹æ®æ ‘ç»“æ„çš„ <code>ä¸­åºéå†</code> è¿›è¡ŒæŸ¥æ‰¾ã€‚åœ¨æ ¹æ®ä¸­åºéå†ï¼Œé¦–å…ˆéœ€è¦è°ƒç”¨ <code>getFirstEntryæ–¹æ³•</code> æŸ¥æ‰¾æœ€å°çš„èŠ‚ç‚¹ï¼›ç„¶åè°ƒç”¨ <code>successoræ–¹æ³•</code> ä¾æ¬¡éå†æ ‘ç»“æ„è¿›è¡Œåˆ¤æ–­ã€‚</p>
<h5 id="getFirstEntryæºç "><a href="#getFirstEntryæºç " class="headerlink" title="getFirstEntryæºç "></a>getFirstEntryæºç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">getFirstEntry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Entry&lt;K,V&gt; p = root;</span><br><span class="line">    <span class="keyword">if</span> (p != <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">while</span> (p.left != <span class="keyword">null</span>)</span><br><span class="line">            p = p.left;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±äºæ˜¯æ ¹æ®æ ‘ç»“æ„çš„ä¸­åºéå†è¿›è¡Œï¼Œæ‰€ä»¥éå†åˆ°çš„ç¬¬ä¸€ä¸ªå…ƒç´ åº”è¯¥æ˜¯æ ‘ç»“æ„ä¸­æœ€å·¦è¾¹å­èŠ‚ç‚¹ã€‚</p>
<h5 id="successoræºç "><a href="#successoræºç " class="headerlink" title="successoræºç "></a>successoræºç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * äºŒå‰æ ‘çš„éå†ï¼Œç®€å•å¯ä»¥åˆ’åˆ†ä¸ºï¼š</span></span><br><span class="line"><span class="comment"> *  1. æ·±åº¦ä¼˜å…ˆ</span></span><br><span class="line"><span class="comment"> *  2. å¹¿åº¦ä¼˜å…ˆ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  å…¶ä¸­ï¼Œæ·±åº¦ä¼˜å…ˆæ ¹æ®æ ¹èŠ‚ç‚¹ç›¸å¯¹äºå·¦å³å­èŠ‚ç‚¹çš„è®¿é—®å…ˆåæ¥åˆ’åˆ†ä¸ºï¼š</span></span><br><span class="line"><span class="comment"> *      1. å…ˆåºéå†ï¼šæŒ‡å…ˆè®¿é—®æ ¹ï¼Œç„¶åè®¿é—®å­æ ‘çš„éå†æ–¹å¼</span></span><br><span class="line"><span class="comment"> *      2. ä¸­åºéå†ï¼šæŒ‡å…ˆè®¿é—®å·¦ï¼ˆå³ï¼‰å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹ï¼Œæœ€åè®¿é—®å³ï¼ˆå·¦ï¼‰å­æ ‘çš„éå†æ–¹å¼</span></span><br><span class="line"><span class="comment"> *      3. ååºéå†ï¼šæŒ‡å…ˆè®¿é—®å­æ ‘ï¼Œç„¶åè®¿é—®æ ¹çš„éå†æ–¹å¼</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  æ–¹æ³• successor() æ˜¯æŒ‰ç…§ä¸­åºéå†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> &lt;K,V&gt; <span class="function">Entry&lt;K,V&gt; <span class="title">successor</span><span class="params">(Entry&lt;K,V&gt; t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¦‚æœèŠ‚ç‚¹tçš„å³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œ</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (t.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Entry&lt;K,V&gt; p = t.right;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// while å¾ªç¯æ‰¾åˆ°ä¸­åºåç»§ç»“ç‚¹  ä¸€ç›´å¾€å·¦æ‰¾</span></span><br><span class="line">        <span class="keyword">while</span> (p.left != <span class="keyword">null</span>)</span><br><span class="line">            p = p.left;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Entry&lt;K,V&gt; p = t.parent;</span><br><span class="line">        Entry&lt;K,V&gt; ch = t;</span><br><span class="line">        <span class="keyword">while</span> (p != <span class="keyword">null</span> &amp;&amp; ch == p.right) &#123;</span><br><span class="line">            ch = p;</span><br><span class="line">            p = p.parent;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³• successor() æ˜¯æŒ‰ç…§ä¸­åºéå†æ ‘ç»“æ„ã€‚</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="ä¸­åºéå†"></p>
<p>å…³äºTreeMapçš„ç§»é™¤æ“ä½œï¼Œæœ‰ç‚¹å¤æ‚ï¼Œä¸åœ¨è®²è¿°äº†ï¼Œçœ‹å‚è€ƒæ–‡ç« å§ğŸ¤¦</p>
<h4 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h4><p><a href="http://www.cnblogs.com/nullllun/p/8214599.html" target="_blank" rel="noopener">çº¢é»‘æ ‘ç®€ä»‹</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86" target="_blank" rel="noopener">æ ‘çš„éå†</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E7%BA%A2%E9%BB%91%E6%A0%91" target="_blank" rel="noopener">çº¢é»‘æ ‘</a></p>
<p><a href="https://www.cnblogs.com/nullllun/p/8251212.html" target="_blank" rel="noopener">TreeMap æºç åˆ†æ</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://houlong123.github.io/2018/02/26/TreeMapæºç å­¦ä¹ /" data-id="cjgovew8a002fmr0mhxscodsx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaåŸºç¡€é›†åˆ/">javaåŸºç¡€é›†åˆ</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/03/18/JVM-å­¦ä¹ /" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          JVM å­¦ä¹ 
        
      </div>
    </a>
  
  
    <a href="/2018/02/24/LinkedHashMapæºç å­¦ä¹ /" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">LinkedHashMapæºç å­¦ä¹ </div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dokuwikiéƒ¨ç½²/">dokuwikiéƒ¨ç½²</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaåŸºç¡€é›†åˆ/">javaåŸºç¡€é›†åˆ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaå¹¶å‘/">javaå¹¶å‘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaå¹¶å‘é”/">javaå¹¶å‘é”</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaå¹¶å‘é›†åˆ/">javaå¹¶å‘é›†åˆ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/éƒ¨ç½²GitHub-Page/">éƒ¨ç½²GitHub Page</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Mysql/" style="font-size: 11.43px;">Mysql</a> <a href="/tags/Spring/" style="font-size: 14.29px;">Spring</a> <a href="/tags/dokuwikiéƒ¨ç½²/" style="font-size: 10px;">dokuwikiéƒ¨ç½²</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/javaåŸºç¡€é›†åˆ/" style="font-size: 18.57px;">javaåŸºç¡€é›†åˆ</a> <a href="/tags/javaå¹¶å‘/" style="font-size: 12.86px;">javaå¹¶å‘</a> <a href="/tags/javaå¹¶å‘é”/" style="font-size: 15.71px;">javaå¹¶å‘é”</a> <a href="/tags/javaå¹¶å‘é›†åˆ/" style="font-size: 17.14px;">javaå¹¶å‘é›†åˆ</a> <a href="/tags/éƒ¨ç½²GitHub-Page/" style="font-size: 10px;">éƒ¨ç½²GitHub Page</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/04/02/ç±»åˆå§‹åŒ–é¡ºåº/">ç±»åˆå§‹åŒ–é¡ºåº</a>
          </li>
        
          <li>
            <a href="/2018/04/01/JVMé¢å¤–çŸ¥è¯†å­¦ä¹ /">JVMé¢å¤–çŸ¥è¯†å­¦ä¹ </a>
          </li>
        
          <li>
            <a href="/2018/03/20/Integerç±»å­¦ä¹ /">Integerç±»å­¦ä¹ </a>
          </li>
        
          <li>
            <a href="/2018/03/18/JVM-å­¦ä¹ /">JVM å­¦ä¹ </a>
          </li>
        
          <li>
            <a href="/2018/02/26/TreeMapæºç å­¦ä¹ /">TreeMapæºç å­¦ä¹ </a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 houlong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
  <a href="https://github.com/houlong123"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 1000;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
</body>
</html>
